<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
	"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Xero Login Example</title>

  <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
  <script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
  <script src="jquery.xerologin.js" type="text/javascript"></script>
	
	<link href="style.css" media="screen" rel="stylesheet" type="text/css" />
</head>

<body>

  <div id="xero_loading" class="modal" style="display: none;">

    <div id="info">

      <p>
        This div is displayed while the popup is active, and is a good place to explain what's going on, or
        show a slick loading indicator! 
        
        <span class="loginText">(<strong>this text is displayed when the login window is still active</strong>).</span>
        <span class="progressText" style="display: none;">(<strong>this is for when your Xero Sync is in progress</strong>).</span>
      </p>
       
      
      <p>
        (They can also <a href="#" onclick="XeroLogin.cancel(); return false;">cancel</a> the process)
      </p>

    </div>

    <div id="cancelOrReopen" style="display: none;">

      <p class="intro">This div is displayed if the user has closed the popup window without completing the process.</p>

      <p>They can <a href="#" onclick="XeroLogin.showLoginWindow(); return false;">Try Again</a> or 
        <a href="#" onclick="XeroLogin.cancel(); return false;">Give up</a>.</p>

    </div>

  </div>
  
  <div class="connectButton">
    
    <p>First, fill out your Xero Login URL. Then:</p>
    
    <button id="btnConnect">Connect to Xero</button>
  
  </div>

  <script type="text/javascript">

    $(document).ready(function() {
      $('#btnConnect').click(function() {

       // for the first parameter, you can specify when the user's OAuth Token is about to expire (use a format that's parseable by )
       // or false to ignore that.
       
       new $.XeroLogin({
          url: '/oauth/xero', // The local URL used to generate the new token request
          autoShow: true
        })
        .done(function() {
          // Handle successful connection
          console.log('Connect successful', arguments);
        })
        .fail(function(reason) {
          // Handle failed connection
          switch(reason) {
            case $.XeroLogin.CLOSED:
              console.log('Connect failed as the window was closed');
              break;
            case $.XeroLogin.CANCELLED:
              console.log('Connect as user cancel login');
              break;
            case $.XeroLogin.FAILED:
              console.log('Connect as login failed');
              break;
          }
        });

      });
    });
    
  </script>

</body>
</html>